<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Statistical Methods for  High Dimensional Biology STAT/BIOF/GSAT 540</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistical Methods for <br>High Dimensional Biology<br><font size=8>STAT/BIOF/GSAT 540</font>
## <font color=red> Lecture 7 â€“ Linear Models</font> <br style=line-height:2> Gabriela Cohen Freue
### <font size=5> Other contributors: Jenny Bryan, Sara Mostafavi, Su-In Lee</font>

---

class: middle
# Book and online resources
&gt; ## Linear Models with R by Julian Faraway, Chapman &amp; Hall/CRC Texts in Statistical Science, 2004

* http://www.biostat.jhsph.edu/~iruczins/teaching/jf/faraway.html

* https://sites.google.com/a/cs.washington.edu/genome560-spr18/CourseMaterials

* http://genomicsclass.github.io/book/

---
class: middle
## Do we think the expression levels at different developmental stages are generated by distributions with different locations? Or a common one?



![](L7_LinearModels_files/figure-html/unnamed-chunk-2-1.svg)&lt;!-- --&gt;

---
class: center, middle

![](L7_LinearModels_files/slide4.png)
---
class: center

![](L7_LinearModels_files/slide5.png)
---
class: center

![](L7_LinearModels_files/slide6.png)
---
class: center

![](L7_LinearModels_files/slide7.png)
---
class: middle




```r
summary(lm(gExp ~ gType, altDat, subset = gene == "Irs4"))
```

```
## 
## Call:
## lm(formula = gExp ~ gType, data = altDat, subset = gene == "Irs4")
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.36575 -0.09072  0.01725  0.09428  0.36525 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.76575    0.03441 225.650   &lt;2e-16 ***
## gTypeNrlKO  -0.02607    0.04931  -0.529      0.6    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.1539 on 37 degrees of freedom
## Multiple R-squared:  0.007497,	Adjusted R-squared:  -0.01933 
## F-statistic: 0.2795 on 1 and 37 DF,  p-value: 0.6002
```

---
class: middle
### Different ways of writing this (design matrix, parameter vector) pair correspond to different parametrizations of the model.
# `$$Y = [X\alpha] + \varepsilon$$`
&lt;br&gt; &lt;big&gt;
 Understanding these concepts makes it easier ...
- to interpret fitted models with confidence
- to fit models such that comparisons you care most about are directly addressed in the inferential "report"

---
class: center

![](L7_LinearModels_files/slide9.png)
---
class: center

![](L7_LinearModels_files/slide10.png)
---
class: middle


```r
lm12 &lt;- summary(hitFitCellMeans)
lm12$coefficients
```

```
##                 Estimate Std. Error  t value     Pr(&gt;|t|)
## devStageE16     5.540857 0.10213807 54.24870 1.307554e-34
## devStageP2      5.844875 0.09554141 61.17635 2.287666e-36
## devStageP6      5.784250 0.09554141 60.54181 3.250790e-36
## devStageP10     6.375125 0.09554141 66.72630 1.223052e-37
## devStage4_weeks 9.173375 0.09554141 96.01465 5.523959e-43
```

---
class: middle

```r
summary(hitFit)
```

```
## 
## Call:
## lm(formula = gExp ~ devStage, data = miniDat, subset = gene == 
##     "theHit")
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.78538 -0.13299 -0.04788  0.17062  0.51814 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.5409     0.1021  54.249  &lt; 2e-16 ***
## devStageP2        0.3040     0.1399   2.174   0.0368 *  
## devStageP6        0.2434     0.1399   1.740   0.0909 .  
## devStageP10       0.8343     0.1399   5.965 9.56e-07 ***
## devStage4_weeks   3.6325     0.1399  25.973  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2702 on 34 degrees of freedom
## Multiple R-squared:  0.9663,	Adjusted R-squared:  0.9623 
## F-statistic: 243.4 on 4 and 34 DF,  p-value: &lt; 2.2e-16
```
---
class: center

![](L7_LinearModels_files/slide11.png)
---
class: center

![](L7_LinearModels_files/slide12.png)
---
class: middle




```
## 
## Call:
## lm(formula = gExp ~ gType * devStage, data = miniDat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.18437 -0.82788 -0.05175  0.80825  1.43067 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 6.53737    0.32754  19.959  &lt; 2e-16 ***
## gTypeNrlKO                  0.01196    0.50032   0.024    0.981    
## devStageP2                  0.20350    0.46321   0.439    0.662    
## devStageP6                  0.06163    0.46321   0.133    0.895    
## devStageP10                 0.45738    0.46321   0.987    0.327    
## devStage4_weeks             2.02125    0.46321   4.364 4.46e-05 ***
## gTypeNrlKO:devStageP2      -0.06533    0.68182  -0.096    0.924    
## gTypeNrlKO:devStageP6       0.12829    0.68182   0.188    0.851    
## gTypeNrlKO:devStageP10     -0.05533    0.68182  -0.081    0.936    
## gTypeNrlKO:devStage4_weeks -0.39683    0.68182  -0.582    0.562    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9264 on 68 degrees of freedom
## Multiple R-squared:  0.3829,	Adjusted R-squared:  0.3012 
## F-statistic: 4.688 on 9 and 68 DF,  p-value: 7.517e-05
```
---
class: center

![](L7_LinearModels_files/slide13.png)
---
class: center

![](L7_LinearModels_files/slide14.png)
---
class: middle
## **How** do we test the **overall** association between the response and a factor?
&lt;big&gt;
Is it easier to use an additive model?
- Additive models are easier and smaller (fewer parameters)
- But in some applications, we need to test the interaction term.
- And it does not always test the overall association between a factor and a response.

![](L7_LinearModels_files/slide15.png)

---
class: middle
## **How** do we test the **overall** association between the response and a factor?

![](L7_LinearModels_files/slide16.png)
---
class: middle
## **How** do we test the **overall** association between the response and a factor?

![](L7_LinearModels_files/slide17.png)
---
class: middle

```r
summary(lm(formula = gExp ~ gType +devStage, data = miniDat))
```

```
## 
## Call:
## lm(formula = gExp ~ gType + devStage, data = miniDat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.2187 -0.8622 -0.1371  0.8317  1.4765 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      6.57172    0.25736  25.535  &lt; 2e-16 ***
## gTypeNrlKO      -0.06817    0.20530  -0.332    0.741    
## devStageP2       0.17656    0.33150   0.533    0.596    
## devStageP6       0.13149    0.33150   0.397    0.693    
## devStageP10      0.43543    0.33150   1.314    0.193    
## devStage4_weeks  1.82856    0.33150   5.516 5.15e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9049 on 72 degrees of freedom
## Multiple R-squared:  0.3766,	Adjusted R-squared:  0.3333 
## F-statistic: 8.698 on 5 and 72 DF,  p-value: 1.73e-06
```
---
Slide 19

---
Slide 20

---
class: middle
## Summary so far
&lt;big&gt;
- *t*-tests can be used to test the equality of **2** population means.

- ANOVA can be used to test the equality of **more than 2** population means.

- **Linear regression** provides a general framework for modelling the relationship between response variable and different type of explanatory variables.

- ***t*-tests** can be used to test the significance of *individual* coefficients.

- **F-tests** can be used to test the *simultaneous significance of multiple coefficients*. We need it to test the association between a response and categorical variable.
---
class: center

![](L7_LinearModels_files/slide22.png)
---

SLIDE 23

---

slide 24

---
class: center

![](L7_LinearModels_files/slide25.png)
---
class: center

![](L7_LinearModels_files/slide26.png)
---

SLIDE 27

---

SLIDE 28

---
class: center, middle

## How do we estimate the intercept and the slope?

### Is there an optimal line?

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
